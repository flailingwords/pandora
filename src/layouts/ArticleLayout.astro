---
import BreadCrumbs from '@/components/BreadCrumbs.astro'
import RootLayout from '@/layouts/RootLayout.astro'
import { convertEpochToString } from '@/lib/utils'
import type { MarkdownHeading } from 'astro'

const { article, headings, sectionsTitle } = Astro.props

const showSections = article.showSections ?? true
---

<RootLayout>
    <div class='article'>
        <BreadCrumbs />
        <div
            class='border-b-px border-b border-slate-600/25 border-b-slate-800/25 dark:border-b-slate-300/25'
        >
            <!-- Add other UI components here, like common headers and footers. -->
            <h1>{article.data.title}</h1>
            <p>by {article.data.authors.join(', ')}</p>
            <!-- 2. Rendered HTML will be passed into the default slot. -->
            <p>Written on: {convertEpochToString(article.data.created)}</p>
            {
                article.data.modified > article ? (
                    <p>
                        Last updated on:{' '}
                        {convertEpochToString(article.data.modified)}
                    </p>
                ) : null
            }
        </div>
        <div class='article-body py-1.5'>
            {
                showSections && headings.length > 0 ? (
                    <div class='float-end rounded-sm border border-slate-800 p-1 dark:border-slate-300'>
                        <p>{sectionsTitle ?? 'Sections'}</p>
                        {headings.map((heading: MarkdownHeading) => (
                            <p>
                                <a
                                    href={
                                        /^\w+/.test(heading.slug[0])
                                            ? `#${heading.slug}`
                                            : heading.slug
                                    }
                                >
                                    {heading.text}
                                </a>
                            </p>
                        ))}
                    </div>
                ) : null
            }
            <slot />
        </div>
    </div>
</RootLayout>
